# 网络编程

## 1.TestIPADDRESS

```java
import java.net.InetAddress;
import java.net.UnknownHostException;

public class TestIPADDRESS {
    public static void main(String[] args) {
        try {
            InetAddress inetAddress = InetAddress.getByName("localhost");
            InetAddress inetAddress1 = InetAddress.getLocalHost();
            System.out.println(inetAddress);
            System.out.println(inetAddress1);
        } catch (UnknownHostException e) {
            e.printStackTrace();
        }
    }
}
```

## 2.端口

端口表示计算机上的一个程序的进程

- 不同的进程有不同的端口号！用来区分软件

- 被规定0~65535；

- TCP,UDP:65535*2个端口。可以重复

- 端口分类
  - 共有端口 0~1023
    - HTTP:80;
    - HTTPS:443;
    - FTP:21;
    - Telent:23
  - 程序注册端口：1024-49151
    - Tomcat:8080;
    - MySQL:3306;
    - Oracle:1521;


## 通信协议

- TCP:用户传输协议

- UDP:用户数据报协议

  ###  TCP UDP对比

​       TCP：打电话

- 双方连接，稳定

- 三次握手 四次挥手

  ~~~ 
  三次握手
  A.你要连接吗？
  B.是的
  A.好的
  
  四次挥手
  A.我要断开了
  B.知道了
  B.你真的要断开吗？
  A.是的
  ~~~

  

- 客户端，服务端

- 传输完成，释放连接，效率低

UDP：发短信

- 不连接，不稳定
- 客户端，服务端
- 可以单向传输

## TCP

客户端

1. 连接服务器

2. 发送消息

3. ```
   package TCP实现聊天;
   
   import java.io.IOException;
   import java.io.OutputStream;
   import java.net.InetAddress;
   import java.net.Socket;
   import java.net.UnknownHostException;
   
   public class send {
       public static void main(String[] args) {
           Socket socket=null;
           OutputStream OS=null;
           try {
               InetAddress ip=InetAddress.getByName("127.0.0.1");
               int port=8962;
               socket = new Socket(ip,port);
               OS=socket.getOutputStream();
               OS.write("你好".getBytes());
           } catch (Exception e) {
               e.printStackTrace();
           }finally {
               if(OS != null){
                   try{
                       OS.close();
                   }catch (IOException e){
                       e.printStackTrace();
                   }
               }
               if(socket!=null){
                   try {
                       socket.close();
                   }catch (IOException e){
                       e.printStackTrace();
                   }
               }
           }
   
       }
   }
   ```

服务端

1.建立服务端口

2.等待用户连接 accept

3.接受用户消息

```
package TCP实现聊天;

import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.net.ServerSocket;
import java.net.Socket;

public class server {
    public static void main(String[] args) {
        ServerSocket serverSocket=null;
        Socket socket=null;
        InputStream is=null;
        ByteArrayOutputStream baos=null;
        try {
            serverSocket = new ServerSocket(8962);
            socket = serverSocket.accept();
            is=socket.getInputStream();
//            byte[] buffer = new byte[1024];
//            int len;
//            while((len = is.read(buffer))!=-1){
//             String str = new String(buffer,0,len);
//             System.out.println(str);
//            }
            baos=new ByteArrayOutputStream();
            byte[] buffer = new  byte[1024];
            int len;
            while((len=is.read(buffer))!=-1){
                baos.write(buffer,0,len);
            }
            System.out.println(baos.toString());
        } catch (IOException e) {
            e.printStackTrace();
        }finally {
       if(baos != null){
           try {
               baos.close();
           }catch (IOException e) {
               e.printStackTrace();
           }
       }
       if(is!=null){
           try{
               is.close();
           }catch (IOException e){
               e.printStackTrace();
           }
       }
            if(socket!=null){
                try{
                    socket.close();
                }catch (IOException e){
                    e.printStackTrace();
                }
            }
            if(serverSocket!=null){
                try{
                    serverSocket.close();
                }catch (IOException e){
                    e.printStackTrace();
                }
            }
        }
    }
}
```